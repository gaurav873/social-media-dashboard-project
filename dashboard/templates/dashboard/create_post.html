{% extends 'dashboard/base.html' %}

{% block title %}Create Post - Social Dashboard{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-8 mx-auto">
            <div class="card">
                <div class="card-header">
                    <h4 class="mb-0">
                        <i class="fas fa-edit"></i> Create New Post
                    </h4>
                </div>
                <div class="card-body">
                    <form method="post">
                        {% csrf_token %}
                        
                        <!-- Post Content -->
                        <div class="mb-3">
                            <label for="content" class="form-label">Post Content</label>
                            <textarea 
                                class="form-control" 
                                id="content" 
                                name="content" 
                                rows="4" 
                                placeholder="What's on your mind?"
                                maxlength="280"
                                required
                            ></textarea>
                            <div class="form-text">
                                <span id="char-count">0</span>/280 characters
                            </div>
                        </div>

                        <!-- Media URL (Optional) -->
                        <div class="mb-3">
                            <label for="media_url" class="form-label">Media URL (Optional)</label>
                            <input 
                                type="url" 
                                class="form-control" 
                                id="media_url" 
                                name="media_url" 
                                placeholder="https://example.com/image.jpg"
                            >
                            <div class="form-text">
                                Add a link to an image or video to include with your post
                            </div>
                        </div>

                        <!-- Platform Selection -->
                        <div class="mb-3">
                            <label class="form-label">Share to Platforms</label>
                            <div class="row">
                                {% for platform in platforms %}
                                <div class="col-md-4 mb-2">
                                    <div class="form-check">
                                        <input 
                                            class="form-check-input" 
                                            type="checkbox" 
                                            name="platforms" 
                                            value="{{ platform }}" 
                                            id="platform_{{ platform }}"
                                        >
                                        <label class="form-check-label" for="platform_{{ platform }}">
                                            {% if platform == 'twitter' %}
                                                <i class="fab fa-twitter text-primary"></i> Twitter
                                            {% elif platform == 'instagram' %}
                                                <i class="fab fa-instagram text-danger"></i> Instagram
                                            {% elif platform == 'facebook' %}
                                                <i class="fab fa-facebook text-primary"></i> Facebook
                                            {% elif platform == 'linkedin' %}
                                                <i class="fab fa-linkedin text-primary"></i> LinkedIn
                                            {% else %}
                                                <i class="fas fa-share-alt"></i> {{ platform|title }}
                                            {% endif %}
                                        </label>
                                    </div>
                                </div>
                                {% empty %}
                                <div class="col-12">
                                    <div class="alert alert-warning">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        No social media accounts connected. 
                                        <a href="{% url 'social_accounts' %}" class="alert-link">Connect accounts</a> to start sharing.
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>

                        <!-- Connected Accounts Info -->
                        {% if social_accounts %}
                        <div class="mb-3">
                            <small class="text-muted">
                                <i class="fas fa-info-circle"></i>
                                Connected accounts: 
                                {% for account in social_accounts %}
                                    <span class="badge bg-secondary">{{ account.platform|title }}: @{{ account.account_username }}</span>
                                {% endfor %}
                            </small>
                        </div>
                        {% endif %}

                        <!-- Submit Button -->
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg" {% if not platforms %}disabled{% endif %}>
                                <i class="fas fa-paper-plane"></i> Share Post
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Platform Guidelines -->
            <div class="card mt-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-info-circle"></i> Platform Guidelines
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6><i class="fab fa-twitter text-primary"></i> Twitter</h6>
                            <ul class="list-unstyled small">
                                <li>• Maximum 280 characters</li>
                                <li>• Use hashtags for better reach</li>
                                <li>• Include mentions with @username</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="fab fa-instagram text-danger"></i> Instagram</h6>
                            <ul class="list-unstyled small">
                                <li>• Maximum 2,200 characters</li>
                                <li>• Use relevant hashtags</li>
                                <li>• Include call-to-action</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Character counter for Twitter
document.getElementById('content').addEventListener('input', function() {
    const count = this.value.length;
    document.getElementById('char-count').textContent = count;
    
    // Change color when approaching limit
    const charCountElement = document.getElementById('char-count');
    if (count > 260) {
        charCountElement.style.color = 'red';
    } else if (count > 240) {
        charCountElement.style.color = 'orange';
    } else {
        charCountElement.style.color = 'inherit';
    }
});
</script>
{% endblock %} 